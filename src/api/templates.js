const translations = {
    ar: {
        title: "WhatsautoBot - أتمتة الواتساب الذكية",
        heroTitle: "حول واتسابك إلى مساعد ذكي",
        heroSub: "قم بربط محادثاتك بجداول بيانات جوجل آلياً، نظم طلباتك، وتواصل مع عملائك باحترافية.",
        openBot: "فتح البوت في تيليجرام",
        features: "المميزات",
        privacy: "سياسة الخصوصية",
        terms: "شروط الخدمة",
        home: "الرئيسية",
        lang: "اللغة",
        feature1: "أتمتة الطلبات",
        feature1Desc: "سحب البيانات من المحادثات وتسجيلها في Google Sheets فوراً.",
        feature2: "ذكاء اصطناعي",
        feature2Desc: "دردشة ذكية تفاعلية تفهم احتياجات عملائك.",
        feature3: "تقارير PDF",
        feature3Desc: "إنشاء فواتير احترافية وإيصالات PDF تلقائياً.",
        legalTitlePrivacy: "سياسة الخصوصية",
        legalTitleTerms: "شروط الخدمة",
        privacyContent: `
            <h2>1. جمع البيانات</h2>
            <p>نحن نحترم خصوصيتك. نطلب فقط الوصول إلى Google Sheets لإدارة طلباتك.</p>
            <h2>2. حماية المعلومات</h2>
            <p>يتم تشفير كافة البيانات والتوكنات ولا يتم مشاركتها أبداً.</p>
        `,
        termsContent: `
            <h2>1. الاتفاقية</h2>
            <p>باستخدامك للبوت، فإنك توافق على شروط الاستخدام والأتمتة الآمنة.</p>
            <h2>2. المسؤولية</h2>
            <p>المستخدم مسؤول عن دقة البيانات والملفات المرتبطة.</p>
        `
    },
    en: {
        title: "WhatsautoBot - Smart WhatsApp Automation",
        heroTitle: "Turn WhatsApp into a Smart Assistant",
        heroSub: "Sync messages to Google Sheets, organize orders, and handle customers with AI-powered brilliance.",
        openBot: "Open Bot on Telegram",
        features: "Features",
        privacy: "Privacy Policy",
        terms: "Terms of Service",
        home: "Home",
        lang: "Language",
        feature1: "Order Automation",
        feature1Desc: "Extract data from chats and log it directly to Google Sheets.",
        feature2: "AI Chatbot",
        feature2Desc: "Advanced interactive chat that understands customer needs.",
        feature3: "PDF Receipts",
        feature3Desc: "Generate professional PDF invoices automatically.",
        legalTitlePrivacy: "Privacy Policy",
        legalTitleTerms: "Terms of Service",
        privacyContent: `
            <h2>1. Data Collection</h2>
            <p>We respect your privacy. We only request access to Google Sheets to manage your orders.</p>
            <h2>2. Information Security</h2>
            <p>All data and tokens are encrypted and never shared with third parties.</p>
        `,
        termsContent: `
            <h2>1. Agreement</h2>
            <p>By using the bot, you agree to our terms of safe automation and usage.</p>
            <h2>2. Liability</h2>
            <p>The user is responsible for the accuracy of data and associated files.</p>
        `
    },
    de: {
        title: "WhatsautoBot - Intelligente WhatsApp-Automatisierung",
        heroTitle: "Verwandeln Sie WhatsApp in einen KI-Assistenten",
        heroSub: "Synchronisieren Sie Nachrichten mit Google Sheets, organisieren Sie Bestellungen und betreuen Sie Kunden mit KI.",
        openBot: "Bot auf Telegram öffnen",
        features: "Funktionen",
        privacy: "Datenschutzerklärung",
        terms: "Nutzungsbedingungen",
        home: "Startseite",
        lang: "Sprache",
        feature1: "Bestell-Automatisierung",
        feature1Desc: "Extrahiert Daten aus Chats und protokolliert sie direkt in Google Sheets.",
        feature2: "KI-Chatbot",
        feature2Desc: "Fortschrittliche interaktive Chats, die Kundenbedürfnisse verstehen.",
        feature3: "PDF-Quittungen",
        feature3Desc: "Erstellen Sie automatisch professionelle PDF-Rechnungen.",
        legalTitlePrivacy: "Datenschutzerklärung",
        legalTitleTerms: "Nutzungsbedingungen",
        privacyContent: `
            <h2>1. Datenerhebung</h2>
            <p>Wir respektieren Ihre Privatsphäre. Wir fordern nur Zugriff auf Google Sheets an, um Ihre Bestellungen zu verwalten.</p>
            <h2>2. Datensicherheit</h2>
            <p>Alle Daten und Token sind verschlüsselt und werden niemals an Dritte weitergegeben.</p>
        `,
        termsContent: `
            <h2>1. Vereinbarung</h2>
            <p>Durch die Nutzung des Bots stimmen Sie unseren Bedingungen für sichere Automatisierung zu.</p>
            <h2>2. Haftung</h2>
            <p>Der Benutzer ist für die Richtigkeit der Daten und der zugehörigen Dateien verantwortlich.</p>
        `
    },
    fr: {
        title: "WhatsautoBot - Automatisation WhatsApp Intelligente",
        heroTitle: "Transformez WhatsApp en Assistant Intelligent",
        heroSub: "Synchronisez les messages avec Google Sheets, organisez les commandes et gérez les clients avec l'IA.",
        openBot: "Ouvrir le Bot sur Telegram",
        features: "Fonctionnalités",
        privacy: "Politique de Confidentialité",
        terms: "Conditions d'Utilisation",
        home: "Accueil",
        lang: "Langue",
        feature1: "Automatisation des Commandes",
        feature1Desc: "Extrayez les données des chats et enregistrez-les directement dans Google Sheets.",
        feature2: "Chatbot IA",
        feature2Desc: "Chat interactif avancé qui comprend les besoins des clients.",
        feature3: "Factures PDF",
        feature3Desc: "Générez automatiquement des factures PDF professionnelles.",
        legalTitlePrivacy: "Politique de Confidentialité",
        legalTitleTerms: "Conditions d'Utilisation",
        privacyContent: `
            <h2>1. Collecte de Données</h2>
            <p>Nous respectons votre vie privée. Nous demandons l'accès à Google Sheets uniquement pour gérer vos commandes.</p>
            <h2>2. Sécurité des Informations</h2>
            <p>Toutes les données et les jetons sont cryptés et ne sont jamais partagés.</p>
        `,
        termsContent: `
            <h2>1. Accord</h2>
            <p>En utilisant le bot, vous acceptez nos conditions d'automatisation sécurisée.</p>
            <h2>2. Responsabilité</h2>
            <p>L'utilisateur est responsable de l'exactitude des données et des fichiers associés.</p>
        `
    }
};

const getBaseLayout = (lang, content) => {
    const t = translations[lang] || translations.ar;
    const isRtl = lang === 'ar';

    return `
<!DOCTYPE html>
<html lang="${lang}" dir="${isRtl ? 'rtl' : 'ltr'}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${t.title}</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;800&family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #0088cc;
            --accent: #00e676;
            --dark: #0f172a;
            --light: #f8fafc;
            --glass: rgba(255, 255, 255, 0.8);
            --font: ${isRtl ? '"Cairo", sans-serif' : '"Outfit", sans-serif'};
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: var(--font);
            background: var(--light);
            color: var(--dark);
            overflow-x: hidden;
            line-height: 1.6;
        }

        a { text-decoration: none; color: inherit; transition: 0.3s; }

        /* Navbar */
        nav {
            padding: 1.5rem 10%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--glass);
            backdrop-filter: blur(10px);
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }

        .logo { font-weight: 800; font-size: 1.5rem; color: var(--primary); }

        .nav-links { display: flex; gap: 2rem; align-items: center; }

        .lang-switcher {
            background: white;
            padding: 5px 10px;
            border-radius: 8px;
            border: 1px solid #ddd;
            font-size: 0.9rem;
        }

        /* Content Shell */
        .content-shell { padding: 4rem 10%; min-height: 80vh; }

        /* Footer */
        footer {
            padding: 3rem 10%;
            background: var(--dark);
            color: white;
            text-align: center;
        }

        .cta-button {
            display: inline-block;
            background: var(--primary);
            color: white;
            padding: 15px 35px;
            border-radius: 12px;
            font-weight: 700;
            margin-top: 2rem;
            box-shadow: 0 10px 20px rgba(0, 136, 204, 0.3);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* Hero */
        .hero { text-align: center; padding: 6rem 0; }
        .hero h1 { font-size: 3.5rem; margin-bottom: 1rem; color: var(--dark); }
        .hero p { font-size: 1.25rem; color: #64748b; max-width: 700px; margin: 0 auto; }

        /* Features */
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-top: 4rem;
        }

        .card {
            background: white;
            padding: 2.5rem;
            border-radius: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.02);
            transition: 0.3s;
            border: 1px solid rgba(0,0,0,0.05);
        }

        .card:hover { transform: translateY(-10px); box-shadow: 0 20px 40px rgba(0,0,0,0.05); }

        .card h3 { margin-bottom: 1rem; color: var(--primary); }

        /* Legal */
        .legal-page { max-width: 900px; margin: 0 auto; background: white; padding: 3rem; border-radius: 20px; box-shadow: 0 4px 20px rgba(0,0,0,0.05); }
        .legal-page h1 { margin-bottom: 2rem; border-bottom: 2px solid var(--primary); padding-bottom: 1rem; }
        .legal-page h2 { margin-top: 2rem; margin-bottom: 1rem; }

        @media (max-width: 768px) {
            .hero h1 { font-size: 2.5rem; }
            nav { padding: 1rem 5%; }
            .nav-links { display: none; }
        }
    </style>
</head>
<body>
    <nav>
        <div class="logo">WhatsautoBot</div>
        <div class="nav-links">
            <a href="/?lang=${lang}">${t.home}</a>
            <a href="/privacy?lang=${lang}">${t.privacy}</a>
            <a href="/terms?lang=${lang}">${t.terms}</a>
            <select class="lang-switcher" onchange="window.location.search = '?lang=' + this.value">
                <option value="ar" ${lang === 'ar' ? 'selected' : ''}>العربية</option>
                <option value="en" ${lang === 'en' ? 'selected' : ''}>English</option>
                <option value="de" ${lang === 'de' ? 'selected' : ''}>Deutsch</option>
                <option value="fr" ${lang === 'fr' ? 'selected' : ''}>Français</option>
            </select>
        </div>
    </nav>

    <div class="content-shell">
        ${content}
    </div>

    <footer>
        <p>&copy; 2024 WhatsautoBot. All rights reserved.</p>
        <div style="margin-top: 1rem; font-size: 0.9rem; opacity: 0.7;">
            <a href="/privacy?lang=${lang}">${t.privacy}</a> | <a href="/terms?lang=${lang}">${t.terms}</a>
        </div>
    </footer>
</body>
</html>
    `;
};

module.exports = {
    renderHome: (lang) => {
        const t = translations[lang] || translations.ar;
        const content = `
            <div class="hero">
                <h1>${t.heroTitle}</h1>
                <p>${t.heroSub}</p>
                <a href="https://t.me/Whatsautoappbot" class="cta-button">${t.openBot}</a>
            </div>

            <div class="features-grid">
                <div class="card">
                    <h3>${t.feature1}</h3>
                    <p>${t.feature1Desc}</p>
                </div>
                <div class="card">
                    <h3>${t.feature2}</h3>
                    <p>${t.feature2Desc}</p>
                </div>
                <div class="card">
                    <h3>${t.feature3}</h3>
                    <p>${t.feature3Desc}</p>
                </div>
            </div>
        `;
        return getBaseLayout(lang, content);
    },

    renderPrivacy: (lang) => {
        const t = translations[lang] || translations.ar;
        const content = `
            <div class="legal-page">
                <h1>${t.legalTitlePrivacy}</h1>
                ${t.privacyContent}
            </div>
        `;
        return getBaseLayout(lang, content);
    },

    renderTerms: (lang) => {
        const t = translations[lang] || translations.ar;
        const content = `
            <div class="legal-page">
                <h1>${t.legalTitleTerms}</h1>
                ${t.termsContent}
            </div>
        `;
        return getBaseLayout(lang, content);
    }
};
